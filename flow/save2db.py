#!/usr/bin/python
# -*- coding: utf-8 -*-

import MySQLdb
import json
import pymysql
def excuteSql(sql):

    cur.execute(sql)
    result = cur.fetchall()
    db.close()
    return result

def saveDNS(filename):
    db = pymysql.connect("localhost", "root", "", "dns")
    cur = db.cursor()
    sqlcmd = '''insert ignore into ipv6 (address,domain,startTime,endTime) values ('{address}','{domain}','{startTime}','{endTime}');'''
    for data in json.load(open(filename,encoding='latin1')).values():
        cmd = sqlcmd.format(
            address = data['address'],
            domain = data['domain'],
            startTime = data['startTime'],
            endTime = data['endTime']
        )
        cur.execute(cmd)
    db.commit()
    db.close()


saveDNS('ipv6.json')

'''CREATE TABLE IF NOT EXISTS `ipv6`(
`startTime` VARCHAR(100) ,
`endTime` VARCHAR(100) ,
`address` VARCHAR(100) ,
`domain` VARCHAR(100) ,
PRIMARY KEY (`address`,`domain` )
)ENGINE=InnoDB DEFAULT CHARSET=utf8;'''
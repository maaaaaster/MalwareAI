import pandas as pd


def loadSha2Url():
    sha2url = {}
    def data2map(data):
        sha = list(data['sha1'])[0]
        sha2url[sha] = list(data['url'])
    filename =  '/home/malware/trace2_test/trojan_web.csv'
    df = pd.read_csv(filename)
    df.groupby('sha1').apply(data2map)
    return sha2url

def checkGroups():
    sha2url = loadSha2Url()
    def checkGroupData(data):
        familyID = list(data['family'])[0]
        shaList = list(data['sha'])
        # if len(shaList) > 1:
        #     return
        for sha in shaList:
            if sha not in sha2url:
                continue
            for url in sha2url[sha]:
                print(sha,familyID,url)
        input()
    group_file = 'trace2.csv'
    df = pd.read_csv(group_file,header=None)
    df.columns=['sha','family']
    df.groupby('family').apply(checkGroupData)



if __name__=='__main__':
    checkGroups()

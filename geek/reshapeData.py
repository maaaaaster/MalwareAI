import pandas as pd

def reSetLine(line):
    line = line.replace('\t',',')
    line = line.strip()
    vals = line.split(',')
    if vals[1].startswith('"'):
        vals[1] = vals[1][1:]
    if vals[1].endswith('"'):
        vals[1] = vals[1][:-1]
    return ','.join(vals)+'\n',len(vals[1])>0 and len(vals[0])>31

def tranFile(inName,outName):
    outf = open(outName,'w+',encoding='utf-8')
    outf.write('sha1,url\n')
    for line in open(inName,encoding='utf-8').readlines():
        newLine,ok = reSetLine(line)
        if ok:
            outf.write(newLine)
        else:
            print(newLine)



if __name__=='__main__':
    tranFile('/home/OpenCode/malware/phase2/trace2_test/trojan_web_raw.csv','/home/OpenCode/malware/phase2/trace2_test/trojan_web.csv')
import re
import os
dirname = 'D:/ai/geek/phase1/trace2_test'
outdir = 'D:/ai/geek/phase1/'
fileMap = {
    'fqdn':os.path.join(dirname,'fqdn_ip.csv'),
    'email':os.path.join(dirname,'trojan_email.csv'),
    'phone':os.path.join(dirname,'trojan_phone.csv'),
    'web':os.path.join(dirname,'trojan_web.csv'),
    'region':os.path.join(dirname,'fqdn_reginfo.csv'),
}
outMap = {
    'all_domain':os.path.join(outdir,'domains.txt'),
    'registered_domain':os.path.join(outdir,'registered.txt'),
    'domainFeature':os.path.join(outdir,'static_domain.txt'),
    'dga2level':os.path.join(outdir,'dga2level.txt'),
    'graph':os.path.join(outdir,'graph.txt'),


}
def checkip(ip):  
    p = re.compile('^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$')  
    if p.match(ip):  
        return True  
    else:  
        return False  

def oneHotFeature(dataList,featureName):
    keys = {}
    for data in dataList:
        key = featureName+data[featureName]
        if key not in keys:
            keys[key] = 0
    for data in dataList:
        data.update(keys)
        key = featureName+data[featureName]
        data[key] = 1
        del(data[featureName])
def clusterSet(vecrot2Group,node2vector):    
    def rootInGroupTree(groupTree,node):
        if node not in groupTree:
            groupTree[node]=node
        while groupTree[node]!=node:
            node=groupTree[node]
        return node
    groupTree = {}
    for node,vectors in node2vector.items():
        group = None
        vectors = list(vectors)
        for vector in vectors:
            if vector not in vecrot2Group:
                continue
            nodeGroup = rootInGroupTree(groupTree,vecrot2Group[vector])
            if group is None:
                group = nodeGroup
            else:
                groupTree[rootInGroupTree(groupTree,vecrot2Group[vector])] = group
    for node  in groupTree:
        groupTree[node] = rootInGroupTree(groupTree,node)

    for vector in vecrot2Group:
        vecrot2Group[vector] = rootInGroupTree(groupTree,vecrot2Group[vector])

    
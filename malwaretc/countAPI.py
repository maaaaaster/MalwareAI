import pandas as pd
import json
# df = pd.read_csv('/home/malware/tc/train.csv')
#
# api2index = {}
# index2api = list(df['api'].drop_duplicates())
# index = 0
# print(index2api)
# for index in range(len(index2api)):
#     api2index[index2api[index]] = index
#
# json.dump(api2index,'data/api2index.json')
# json.dump(index2api,'data/index2api.json')
trainlist = ['GetSystemTimeAsFileTime', 'NtAllocateVirtualMemory', 'NtFreeVirtualMemory', 'SetUnhandledExceptionFilter', 'LdrLoadDll', 'LdrGetProcedureAddress', 'LdrUnloadDll', 'NtCreateMutant', 'NtCreateSection', 'NtMapViewOfSection', 'CoInitializeEx', 'RegOpenKeyExW', 'CoUninitialize', 'NtUnmapViewOfSection', 'NtClose', 'LdrGetDllHandle', 'NtTerminateProcess', 'NtOpenKey', 'NtQueryValueKey', '__exception__', 'SetErrorMode', 'RegQueryValueExW', 'RegCloseKey', 'NtCreateFile', 'NtWriteFile', 'CreateProcessInternalW', 'NtProtectVirtualMemory', 'RegOpenKeyExA', 'NtQueryAttributesFile', 'LoadStringA', 'GetSystemMetrics', 'RegQueryValueExA', 'FindResourceExW', 'LoadResource', 'GetSystemWindowsDirectoryW', 'FindResourceA', 'SizeofResource', 'GetFileVersionInfoSizeW', 'GetFileVersionInfoW', 'DrawTextExA', 'WSAStartup', 'socket', 'setsockopt', 'closesocket', 'bind', 'NtSetInformationFile', 'NtDeviceIoControlFile', 'CreateThread', 'NtOpenFile', 'GetSystemDirectoryW', 'NtOpenMutant', 'NtOpenSection', 'RegEnumKeyExW', 'LoadStringW', 'GetCursorPos', 'EnumWindows', 'GetKeyState', 'NtQuerySystemInformation', 'FindFirstFileExW', 'NtOpenDirectoryObject', 'GetVolumePathNameW', 'CreateDirectoryW', 'GetFileAttributesW', 'DeleteFileW', 'CopyFileA', 'CreateToolhelp32Snapshot', 'Thread32First', 'Thread32Next', 'NtDuplicateObject', 'GetSystemInfo', 'NtOpenKeyEx', 'GetTempPathW', 'SetFilePointer', 'NtReadFile', 'GetFileType', 'GetTimeZoneInformation', 'SetWindowsHookExA', 'NtEnumerateKey', 'NtQueryInformationFile', 'listen', 'connect', 'gethostbyname', 'NtOpenProcess', 'WriteProcessMemory', 'RtlAddVectoredExceptionHandler', 'ReadProcessMemory', 'FindWindowA', 'SHGetFolderPathW', 'CreateActCtxW', 'FindResourceW', 'SetWindowsHookExW', 'GetForegroundWindow', 'RegQueryInfoKeyW', 'RegEnumValueW', 'GetFileSizeEx', 'DrawTextExW', 'Process32FirstW', 'Process32NextW', 'NtReadVirtualMemory', 'OutputDebugStringA', 'SearchPathW', 'OleInitialize', 'CryptAcquireContextW', 'GetFileSize', 'SetEndOfFile', 'GlobalMemoryStatus', 'CoGetClassObject', 'CoCreateInstance', 'NtQueryKey', 'NtSetValueKey', 'NtDelayExecution', 'RegEnumKeyW', 'NtQueryDirectoryFile', 'GetFileInformationByHandleEx', 'NtEnumerateValueKey', 'GetUserNameExW', 'GetComputerNameW', 'GetUserNameW', 'DeviceIoControl', 'FindWindowW', 'RegCreateKeyExW', 'SendNotifyMessageW', 'RegSetValueExW', 'GetFileAttributesExW', 'GetFileInformationByHandle', 'SetFileTime', 'LookupAccountSidW', 'IsDebuggerPresent', 'NtResumeThread', 'GlobalMemoryStatusEx', 'GetShortPathNameW', 'NtCreateKey', 'CoInitializeSecurity', 'UuidCreate', 'NtCreateThreadEx', 'RtlAddVectoredContinueHandler', 'LookupPrivilegeValueW', 'NtOpenThread', 'Module32FirstW', 'Module32NextW', 'GetKeyboardState', 'WriteConsoleA', 'GetVolumeNameForVolumeMountPointW', 'NtQueryFullAttributesFile', 'SetFilePointerEx', 'GetVolumePathNamesForVolumeNameW', 'system', 'WriteConsoleW', 'RemoveDirectoryA', 'GetNativeSystemInfo', 'GetSystemDirectoryA', 'CopyFileW', 'GetAdaptersInfo', 'RegEnumValueA', 'RegDeleteValueW', 'RegCreateKeyExA', 'GetUserNameA', 'SetFileAttributesW', 'RegEnumKeyExA', 'OpenSCManagerA', 'OpenServiceA', 'RegSetValueExA', 'RegDeleteValueA', 'InternetCrackUrlA', 'InternetSetOptionA', 'InternetGetConnectedState', 'InternetOpenW', 'InternetSetStatusCallback', 'InternetConnectW', 'HttpOpenRequestW', 'InternetQueryOptionA', 'HttpSendRequestW', 'HttpQueryInfoA', 'InternetCloseHandle', 'getaddrinfo', 'GetAdaptersAddresses', 'getsockname', 'select', 'CryptProtectMemory', 'CryptUnprotectMemory', 'GetComputerNameA', 'GetFileVersionInfoSizeExW', 'GetFileVersionInfoExW', 'InternetCrackUrlW', 'SHGetSpecialFolderLocation', 'CryptHashData', 'NetUserGetInfo', 'shutdown', 'CreateServiceA', 'StartServiceA', 'ShellExecuteExW', 'SetStdHandle', 'NtQueryMultipleValueKey', 'CreateJobObjectW', 'SetInformationJobObject', 'GetSystemWindowsDirectoryA', 'FindResourceExA', 'RemoveDirectoryW', 'GetDiskFreeSpaceExW', 'MoveFileWithProgressW', 'NetShareEnum', 'RegDeleteKeyW', 'GetDiskFreeSpaceW', 'RegQueryInfoKeyA', 'OpenSCManagerW', 'OpenServiceW', 'CryptAcquireContextA', 'GetAddrInfoW', 'NtTerminateThread', 'CreateServiceW', 'NtDeleteKey', 'GetBestInterfaceEx', 'timeGetTime', 'InternetOpenA', 'CryptEncrypt', 'InternetConnectA', 'HttpOpenRequestA', 'HttpSendRequestA', 'StartServiceW', 'ControlService', 'DeleteService', 'CryptExportKey', 'CryptCreateHash', 'WSASocketW', 'NtSuspendThread', 'NtGetContextThread', 'UnhookWindowsHookEx', 'CertOpenStore', 'CryptDecodeObjectEx', 'CertControlStore', 'NtDeleteValueKey', 'GetAsyncKeyState', 'EnumServicesStatusW', 'DnsQuery_W', 'FindWindowExW', 'FindFirstFileExA', 'RegDeleteKeyA', 'FindWindowExA', 'InternetOpenUrlA', 'SendNotifyMessageA', 'CoCreateInstanceEx', 'IWbemServices_ExecQuery', 'WSASocketA', 'URLDownloadToFileW', 'accept', 'NtCreateDirectoryObject', 'CertCreateCertificateContext', 'AssignProcessToJobObject', 'SetFileInformationByHandle', 'NetGetJoinInformation', 'InternetReadFile', 'RtlRemoveVectoredExceptionHandler', 'CryptGenKey', 'MessageBoxTimeoutA', 'NetUserGetLocalGroups', 'DeleteUrlCacheEntryW', 'send', 'recv', 'ioctlsocket', 'WSARecv', 'WSASend', 'sendto', 'CopyFileExW', 'RegisterHotKey', 'MessageBoxTimeoutW', 'CreateRemoteThread', 'GetUserNameExA', 'EnumServicesStatusA', 'NtQueueApcThread', 'RtlCreateUserThread', 'InternetOpenUrlW', 'CryptProtectData', 'WSAConnect', 'CryptDecrypt', 'CreateDirectoryExW', 'IWbemServices_ExecMethod', 'recvfrom', 'ObtainUserAgentString', 'DnsQuery_A', 'ReadCabinetState', 'NtSetContextThread', 'WSARecvFrom', 'WSASendTo', 'NtLoadKey', 'NtLoadDriver', 'DeleteUrlCacheEntryA', 'GetInterfaceInfo', 'NtWriteVirtualMemory', 'RtlCompressBuffer', 'NtShutdownSystem', 'TaskDialog', 'NtDeleteFile', 'InternetGetConnectedStateExW', 'CryptUnprotectData', 'InternetGetConnectedStateExA', 'NtSaveKeyEx', 'NtSaveKey', 'CertOpenSystemStoreA', 'PRF', 'ExitWindowsEx', 'WSAAccept', 'CreateRemoteThreadEx', 'CertOpenSystemStoreW', 'NtUnloadDriver', 'NtCreateThread', 'NtLoadKeyEx', 'InternetWriteFile', 'RtlDecompressBuffer']
testlist = ['NtAllocateVirtualMemory', 'NtFreeVirtualMemory', 'GetFileType', 'LdrGetDllHandle', 'LdrGetProcedureAddress', 'SetUnhandledExceptionFilter', 'GetCursorPos', 'RegOpenKeyExA', 'RegCloseKey', 'RegQueryValueExA', 'GetSystemMetrics', 'SetErrorMode', 'LoadStringA', 'SetWindowsHookExA', 'RegCreateKeyExA', 'LdrLoadDll', 'NtOpenSection', 'NtMapViewOfSection', 'RegOpenKeyExW', 'RegQueryValueExW', 'NtClose', 'GetSystemWindowsDirectoryW', 'NtCreateFile', 'NtCreateSection', 'CreateActCtxW', 'GetSystemDirectoryW', 'GetVolumeNameForVolumeMountPointW', 'RegEnumKeyW', 'NtQueryDirectoryFile', 'CoCreateInstance', 'GetFileSizeEx', 'NtReadFile', 'GetFileInformationByHandleEx', 'GetSystemTimeAsFileTime', 'GetVolumePathNameW', 'NtOpenProcess', 'NtOpenKey', 'CoInitializeEx', 'CoUninitialize', 'NtOpenFile', 'RegSetValueExA', 'FindFirstFileExW', 'FindResourceExA', 'LoadResource', 'NtQueryValueKey', 'FindResourceExW', 'RegQueryInfoKeyW', 'RegEnumValueW', 'RegEnumKeyExW', 'FindResourceA', 'LdrUnloadDll', 'OleInitialize', 'CoInitializeSecurity', 'UuidCreate', 'CryptAcquireContextW', 'CreateThread', 'NtOpenMutant', 'NtUnmapViewOfSection', 'LoadStringW', 'NtCreateMutant', 'GetNativeSystemInfo', 'NtQuerySystemInformation', 'GlobalMemoryStatusEx', 'NtDuplicateObject', 'GetVolumePathNamesForVolumeNameW', 'WriteConsoleA', 'NtTerminateProcess', 'GetFileSize', 'GetTempPathW', 'NtQueryAttributesFile', 'SetFileTime', 'NtQueryInformationFile', 'NtQueryKey', 'NtOpenKeyEx', 'NtEnumerateKey', 'SizeofResource', 'SearchPathW', 'GetSystemInfo', 'NtProtectVirtualMemory', 'GetFileAttributesW', 'EnumWindows', 'GetForegroundWindow', 'DrawTextExW', 'WriteProcessMemory', 'GlobalMemoryStatus', 'GetSystemDirectoryA', 'CreateDirectoryW', 'GetFileAttributesExW', 'SetFilePointerEx', 'SetFilePointer', 'DeleteFileW', 'NtWriteFile', 'NtSetInformationFile', 'NtDelayExecution', '__exception__', 'SHGetFolderPathW', 'SendNotifyMessageW', 'NtCreateThreadEx', 'NtResumeThread', 'GetTimeZoneInformation', 'LookupAccountSidW', 'GetFileVersionInfoSizeW', 'GetFileVersionInfoW', 'NtEnumerateValueKey', 'WriteConsoleW', 'OpenSCManagerW', 'ShellExecuteExW', 'NtOpenDirectoryObject', 'IsDebuggerPresent', 'RtlAddVectoredExceptionHandler', 'GetShortPathNameW', 'GetFileInformationByHandle', 'EnumServicesStatusW', 'EncryptMessage', 'closesocket', 'GetUserNameW', 'RegDeleteValueW', 'RegSetValueExW', 'CreateProcessInternalW', 'FindResourceW', 'SetWindowsHookExW', 'CreateToolhelp32Snapshot', 'Process32FirstW', 'Process32NextW', 'FindWindowW', 'UnhookWindowsHookEx', 'ReadProcessMemory', 'FindWindowA', 'WSAStartup', 'SetFileAttributesW', 'RegCreateKeyExW', 'SetEndOfFile', 'DrawTextExA', 'FindWindowExA', 'GetKeyState', 'CopyFileA', 'Thread32First', 'Thread32Next', 'NtDeviceIoControlFile', 'CoGetClassObject', 'GetComputerNameA', 'getaddrinfo', 'socket', 'connect', 'RtlAddVectoredContinueHandler', 'CryptAcquireContextA', 'CryptExportKey', 'CryptCreateHash', 'CryptHashData', 'NtCreateKey', 'DeviceIoControl', 'NtSetValueKey', 'CertOpenStore', 'CryptDecodeObjectEx', 'CertControlStore', 'NtDeleteValueKey', 'GetAdaptersAddresses', 'GetBestInterfaceEx', 'NtOpenThread', 'GetAddrInfoW', 'Module32FirstW', 'NtReadVirtualMemory', 'Module32NextW', 'GetComputerNameW', 'GetKeyboardState', 'InternetGetConnectedState', 'InternetQueryOptionA', 'RegEnumValueA', 'InternetCrackUrlA', 'InternetSetOptionA', 'InternetOpenW', 'InternetSetStatusCallback', 'InternetConnectW', 'HttpOpenRequestW', 'HttpSendRequestW', 'RegEnumKeyExA', 'HttpQueryInfoA', 'SetFileInformationByHandle', 'NtQueryFullAttributesFile', 'InternetCloseHandle', 'OpenSCManagerA', 'OpenServiceA', 'bind', 'getsockname', 'select', 'GetUserNameA', 'LookupPrivilegeValueW', 'OpenServiceW', 'RemoveDirectoryA', 'GetDiskFreeSpaceW', 'SHGetSpecialFolderLocation', 'CryptEncrypt', 'GetDiskFreeSpaceExW', 'GetUserNameExW', 'SendNotifyMessageA', 'GetSystemWindowsDirectoryA', 'GetAsyncKeyState', 'timeGetTime', 'OutputDebugStringA', 'GetAdaptersInfo', 'CoCreateInstanceEx', 'WSASocketA', 'listen', 'NtSuspendThread', 'InternetOpenA', 'InternetConnectA', 'HttpOpenRequestA', 'HttpSendRequestA', 'IWbemServices_ExecQuery', 'InternetOpenUrlW', 'CreateServiceA', 'StartServiceA', 'SetStdHandle', 'WSASocketW', 'setsockopt', 'InternetReadFile', 'NtGetContextThread', 'InternetOpenUrlA', 'NetShareEnum', 'RemoveDirectoryW', 'InternetCrackUrlW', 'gethostbyname', 'RegisterHotKey', 'NtDeleteKey', 'RegDeleteKeyW', 'ioctlsocket', 'RegDeleteValueA', 'GetFileVersionInfoSizeExW', 'GetFileVersionInfoExW', 'FindWindowExW', 'RtlRemoveVectoredExceptionHandler', 'CopyFileW', 'CertCreateCertificateContext', 'FindFirstFileExA', 'CreateServiceW', 'StartServiceW', 'MoveFileWithProgressW', 'NetGetJoinInformation', 'WSARecvFrom', 'MessageBoxTimeoutW', 'ControlService', 'CreateJobObjectW', 'SetInformationJobObject', 'AssignProcessToJobObject', 'NtQueueApcThread', 'URLDownloadToFileW', 'shutdown', 'CryptDecrypt', 'RegQueryInfoKeyA', 'RegDeleteKeyA', 'RtlDecompressBuffer', 'NtSetContextThread', 'sendto', 'DeleteService', 'CreateRemoteThread', 'MessageBoxTimeoutA', 'CryptProtectMemory', 'CryptUnprotectMemory', 'NtTerminateThread', 'NtWriteVirtualMemory', 'NtQueryMultipleValueKey', 'NetUserGetInfo', 'CryptGenKey', 'DeleteUrlCacheEntryW', 'WSASend', 'GetUserNameExA', 'IWbemServices_ExecMethod', 'accept', 'DeleteUrlCacheEntryA', 'recvfrom', 'send', 'RtlCreateUserThread', 'WSAConnect', 'ObtainUserAgentString', 'WSARecv', 'InternetWriteFile', 'recv', 'CertOpenSystemStoreA', 'CryptProtectData', 'DnsQuery_W', 'CertOpenSystemStoreW', 'CopyFileExW', 'NtLoadKey', 'NtLoadKey2', 'NtSaveKey', 'InternetGetConnectedStateExA', 'WSASendTo', 'ReadCabinetState', 'CryptUnprotectData', 'RtlCompressBuffer', 'EnumServicesStatusA', 'NtUnloadDriver', 'DnsQuery_A', 'NtSaveKeyEx', 'NtLoadKeyEx', 'CreateDirectoryExW', 'ExitWindowsEx', 'system', 'GetInterfaceInfo', 'TaskDialog', 'NtLoadDriver', 'NtDeleteFile', 'NetUserGetLocalGroups', 'NtCreateDirectoryObject', 'WNetGetProviderNameW', 'CreateRemoteThreadEx']
apilist = ['InternetOpenUrlW', 'system', 'listen', 'Module32FirstW', 'GetAddrInfoW', 'WSASocketW', 'NtOpenMutant', 'NtReadVirtualMemory', 'GetSystemMetrics', 'SetFileInformationByHandle', 'SetInformationJobObject', 'NtSuspendThread', 'NtProtectVirtualMemory', 'RtlCreateUserThread', 'ReadCabinetState', 'GetFileVersionInfoW', 'GetAdaptersAddresses', 'CreateJobObjectW', 'GetBestInterfaceEx', 'RtlCompressBuffer', 'NtSaveKeyEx', 'RegOpenKeyExW', 'OpenServiceA', 'NtLoadDriver', 'EncryptMessage', 'NtOpenSection', 'GetSystemDirectoryW', 'InternetSetOptionA', 'NtQueryMultipleValueKey', 'SetFilePointer', 'OpenSCManagerW', 'GetFileSizeEx', 'SetStdHandle', 'Process32FirstW', 'DeleteUrlCacheEntryW', 'GetCursorPos', 'GetUserNameW', 'InternetOpenW', 'NetUserGetInfo', 'NtTerminateProcess', 'CreateToolhelp32Snapshot', 'GetUserNameExW', 'RegCloseKey', 'GetFileType', 'UuidCreate', 'RemoveDirectoryA', 'CopyFileW', 'GlobalMemoryStatus', 'SetEndOfFile', 'RegDeleteValueA', 'InternetConnectW', 'NtQueryAttributesFile', 'CryptProtectMemory', 'RegEnumValueA', 'timeGetTime', 'GetFileVersionInfoSizeW', 'NtDeviceIoControlFile', 'RegDeleteKeyA', 'NtCreateMutant', 'socket', 'RegQueryValueExA', 'send', 'LoadStringW', 'GetFileAttributesW', 'DeleteUrlCacheEntryA', 'FindWindowW', 'GetSystemWindowsDirectoryW', 'StartServiceA', 'CreateServiceA', 'GetKeyboardState', 'NtDuplicateObject', 'CoCreateInstanceEx', 'GetSystemInfo', 'InternetConnectA', 'NtUnmapViewOfSection', 'GetFileSize', 'CreateDirectoryExW', 'CoInitializeSecurity', 'NtOpenProcess', 'LoadResource', 'UnhookWindowsHookEx', 'NtLoadKey', 'RtlAddVectoredContinueHandler', 'SetFilePointerEx', 'InternetQueryOptionA', 'OpenServiceW', 'CreateServiceW', 'GetTimeZoneInformation', 'shutdown', 'NtOpenKey', 'GetFileInformationByHandleEx', 'RegEnumKeyExA', 'CryptDecrypt', 'SHGetFolderPathW', 'InternetCloseHandle', 'DnsQuery_W', 'OleInitialize', 'recvfrom', 'Thread32Next', 'setsockopt', 'DeviceIoControl', 'RegSetValueExA', 'SetUnhandledExceptionFilter', 'LdrGetProcedureAddress', 'NtQueueApcThread', 'GetNativeSystemInfo', 'SHGetSpecialFolderLocation', 'FindResourceExW', 'GetDiskFreeSpaceExW', 'HttpSendRequestW', 'EnumWindows', 'OutputDebugStringA', 'RegEnumValueW', 'CryptCreateHash', 'FindResourceW', 'ioctlsocket', 'ExitWindowsEx', 'Thread32First', 'HttpSendRequestA', 'NtQueryFullAttributesFile', 'NtFreeVirtualMemory', 'IWbemServices_ExecMethod', 'InternetGetConnectedStateExA', 'NtCreateThreadEx', 'MessageBoxTimeoutA', 'NtSetValueKey', 'DrawTextExW', 'recv', 'CopyFileA', 'GetVolumePathNamesForVolumeNameW', 'DeleteService', 'WSAConnect', 'ReadProcessMemory', 'InternetWriteFile', 'GetDiskFreeSpaceW', 'SetWindowsHookExW', 'WriteConsoleA', 'NtLoadKeyEx', 'NetShareEnum', 'GetFileAttributesExW', 'GetFileVersionInfoSizeExW', 'GetSystemTimeAsFileTime', 'NtSaveKey', 'StartServiceW', 'GetSystemWindowsDirectoryA', 'GetKeyState', 'NtResumeThread', 'GetComputerNameW', 'CopyFileExW', 'NtOpenKeyEx', 'RemoveDirectoryW', 'NtMapViewOfSection', 'FindWindowA', 'NtCreateDirectoryObject', 'InternetOpenA', 'InternetSetStatusCallback', 'CoCreateInstance', 'LookupAccountSidW', 'LdrGetDllHandle', 'FindWindowExA', 'CertOpenSystemStoreW', 'GetFileVersionInfoExW', 'CreateActCtxW', 'LookupPrivilegeValueW', 'LoadStringA', 'SizeofResource', 'WriteConsoleW', 'CreateProcessInternalW', 'GetAsyncKeyState', 'CoInitializeEx', 'CryptProtectData', 'NetUserGetLocalGroups', 'gethostbyname', 'GetVolumeNameForVolumeMountPointW', 'NtQueryKey', 'ObtainUserAgentString', 'RegDeleteValueW', 'CoGetClassObject', 'FindFirstFileExW', 'RegisterHotKey', 'connect', 'getaddrinfo', 'WriteProcessMemory', 'DeleteFileW', 'RtlRemoveVectoredExceptionHandler', 'NtCreateKey', 'InternetOpenUrlA', 'ControlService', 'DrawTextExA', 'CryptAcquireContextA', 'SetFileTime', 'DnsQuery_A', 'NtCreateThread', 'NtTerminateThread', 'CryptUnprotectData', 'NtQueryDirectoryFile', 'InternetCrackUrlA', 'HttpOpenRequestA', 'RtlAddVectoredExceptionHandler', 'EnumServicesStatusA', 'NtOpenThread', 'GetVolumePathNameW', '__exception__', 'WSASocketA', 'WSAAccept', 'GetShortPathNameW', 'accept', 'NtEnumerateValueKey', 'GetForegroundWindow', 'NtQueryInformationFile', 'NtClose', 'RegSetValueExW', 'CertControlStore', 'FindFirstFileExA', 'CryptAcquireContextW', 'LdrUnloadDll', 'CertCreateCertificateContext', 'RegCreateKeyExW', 'SearchPathW', 'SetFileAttributesW', 'SetWindowsHookExA', 'NtSetContextThread', 'InternetCrackUrlW', 'NtDeleteValueKey', 'SendNotifyMessageA', 'CoUninitialize', 'GetSystemDirectoryA', 'NtShutdownSystem', 'RtlDecompressBuffer', 'SendNotifyMessageW', 'CryptHashData', 'CryptGenKey', 'NtOpenFile', 'bind', 'FindResourceExA', 'OpenSCManagerA', 'GetComputerNameA', 'NtCreateSection', 'Process32NextW', 'NtDelayExecution', 'CryptDecodeObjectEx', 'EnumServicesStatusW', 'select', 'NetGetJoinInformation', 'SetErrorMode', 'IWbemServices_ExecQuery', 'WSARecvFrom', 'CertOpenSystemStoreA', 'WSASendTo', 'NtWriteFile', 'InternetGetConnectedState', 'GetUserNameA', 'getsockname', 'HttpQueryInfoA', 'NtCreateFile', 'NtAllocateVirtualMemory', 'FindWindowExW', 'ShellExecuteExW', 'sendto', 'AssignProcessToJobObject', 'NtReadFile', 'URLDownloadToFileW', 'CertOpenStore', 'NtDeleteFile', 'RegCreateKeyExA', 'MoveFileWithProgressW', 'NtWriteVirtualMemory', 'Module32NextW', 'CreateDirectoryW', 'InternetGetConnectedStateExW', 'GetInterfaceInfo', 'RegQueryInfoKeyW', 'RegQueryInfoKeyA', 'NtLoadKey2', 'TaskDialog', 'NtSetInformationFile', 'CreateThread', 'NtGetContextThread', 'CreateRemoteThreadEx', 'WNetGetProviderNameW', 'GetTempPathW', 'RegDeleteKeyW', 'RegOpenKeyExA', 'CryptEncrypt', 'CreateRemoteThread', 'FindResourceA', 'NtQuerySystemInformation', 'CryptUnprotectMemory', 'HttpOpenRequestW', 'NtDeleteKey', 'InternetReadFile', 'IsDebuggerPresent', 'RegEnumKeyExW', 'RegEnumKeyW', 'MessageBoxTimeoutW', 'CryptExportKey', 'WSARecv', 'NtUnloadDriver', 'LdrLoadDll', 'WSAStartup', 'GetUserNameExA', 'NtEnumerateKey', 'RegQueryValueExW', 'PRF', 'NtOpenDirectoryObject', 'closesocket', 'NtQueryValueKey', 'WSASend', 'GetFileInformationByHandle', 'GlobalMemoryStatusEx', 'GetAdaptersInfo']

trainset = set(trainlist)
testset = set(testlist)
print(trainset-testset)
print(testset-trainset)
result = []
for index in range(len(apilist)):
    api = apilist[index]
    if api in testset & trainset:
        result.append(str(index))
print(result)
print(len(result))
b = ['10', '100', '101', '102', '103', '104', '105', '106', '107', '108', '109', '11',
                 '110', '111', '112', '113', '114', '115', '116', '117', '118', '119', '12', '120',
                 '121', '122', '123', '124', '125', '126', '127', '128', '129', '13', '130', '131', '132',
                 '133', '134', '135', '136', '137', '138', '139', '14', '140', '141', '142', '143', '144',
                 '145', '146', '147', '148', '149', '15', '150', '151', '152', '153', '154', '155', '156',
                 '157', '158', '159', '16', '160', '161', '162', '163', '164', '165', '166', '167', '168',
                 '169', '17', '170', '171', '172', '173', '174', '175', '176', '177', '178', '179', '18',
                 '180', '181', '182', '183', '184', '185', '186', '187', '188', '189', '19', '190', '191',
                 '193', '194', '195', '196', '197', '198', '199', '20', '200', '201', '202', '203', '205',
                 '206', '207', '208', '209', '21', '210', '211', '212', '213', '214', '215', '216', '217',
                 '218', '219', '22', '220', '221', '222', '223', '224', '225', '226', '228', '229', '23',
                 '230', '231', '232', '233', '234', '235', '236', '237', '238', '239', '240', '241', '242',
                 '243', '244', '245', '246', '247', '248', '249', '25', '250', '251', '252', '253', '254',
                 '255', '256', '257', '258', '259', '26', '260', '261', '262', '263', '264', '265', '266',
                 '267', '268', '27', '270', '271', '272', '274', '275', '276', '277', '278', '28', '280',
                 '281', '282', '283', '284', '285', '286', '287', '288', '289', '29', '290', '291', '292',
                 '293', '294', '295', '296', '297', '298', '299', '30', '300', '301', '302', '304', '305',
                 '306','307', '308', '309', '31', '310', '32', '33', '34', '35', '36', '37', '38', '39',
                 '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54',
                 '55', '56', '57', '58', '59', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69',
                 '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '80', '81', '82', '83', '84',
                 '85', '86', '87', '88', '89', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99']
print(set(b)-set(result))
print(set(result)-set(b))


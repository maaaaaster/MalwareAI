import pandas as pd
import os

phase1 = 'D:/ai/geek/phase1/trace2_test'
phase2 = '/home/OpenCode/malware/phase2/trace2_test'

basedir = phase2

webfile = os.path.join(basedir,'trojan_web.csv')
ipfile = os.path.join(basedir,'fqdn_ip.csv')
reginfofile = os.path.join(basedir,'fqdn_reginfo.csv')
phone = os.path.join(basedir,'trojan_phone.csv')
email = os.path.join(basedir,'trojan_email.csv')

shaDF = pd.read_csv(webfile)

def checkGroup(data):
    ok = 0
    for sha in data.sha1:
        t = shaDF[shaDF.sha1==sha]['url']
        if t.shape[0]>0:
            print(sha)
            print(t[:5])
            ok += 1
    if ok > 1:
        print('___________________________')
        input()
df = pd.read_csv('/home/malware/trace2.csv',header=None)
df.columns = ['sha1','familyId']
for x in df.groupby('familyId'):
    line,col = x[1].shape
    if line==1:
        checkGroup(x[1])
        input()


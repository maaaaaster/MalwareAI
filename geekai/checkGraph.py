import pandas as pd
import os

phase1 = 'D:/ai/geek/phase1/trace2_test'

basedir = phase1

webfile = os.path.join(basedir,'trojan_web.csv')
ipfile = os.path.join(basedir,'fqdn_ip.csv')
reginfofile = os.path.join(basedir,'fqdn_reginfo.csv')
phone = os.path.join(basedir,'trojan_phone.csv')
email = os.path.join(basedir,'trojan_email.csv')

shaDF = pd.read_csv(webfile)

def checkGroup(data):
    ok = 0
    for sha in data.sha1:
        t = shaDF[shaDF.sha1==sha]['url']
        if t.shape[0]>0:
            print(sha)
            print(t[:5])
            ok += 1
    if ok > 1:
        print('___________________________')
        input()
df = pd.read_csv('trace2.csv',header=None)
df.columns = ['sha1','familyId']
for x in df.groupby('familyId'):
    if x[0]<9805:
        continue
    print(x[0])
    line,col = x[1].shape
    if line==1:
        continue
    checkGroup(x[1])
